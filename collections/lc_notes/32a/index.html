<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><title>Median in a Stream | DAXPY</title><link rel=stylesheet href=/css/main.min.94a2540136d9a839e3ae21136b6ed35c457b231d8bd1a157c7089710a8682c84.css integrity="sha256-lKJUATbZqDnjriETa27TXEV7Ix2L0aFXxwiXEKhoLIQ=" crossorigin=anonymous><script src=/js/main.23cd0c7d837263b9eaeb96ee2d9ccfa2969daa3fa00fa1c1fe8701a9b87251a1.js integrity="sha256-I80MfYNyY7nq65buLZzPopadqj+gD6HB/ocBqbhyUaE=" crossorigin=anonymous></script></head><body><header><nav><ul><li><a class=text_secondary href=https://daxpy.xyz/>DAXPY</a></li><li>|</li><li><a href=https://daxpy.xyz/posts/>Posts</a></li><li><a href=https://daxpy.xyz/notes/>Notes</a></li><li><a href=https://daxpy.xyz/collections/>Collections</a></li><li><a href=https://daxpy.xyz/links/>Links</a></li><li><a href=https://daxpy.xyz/stories/>Stories</a></li><li><a href=/about>About</a></li></ul></nav></header><main><section><div style=text-align:right;height:5px;margin-top:10px class=italic>this page
⟩ <a href=/collections/lc_notes/>lc notes</a>
⟩ <a href=/collections/>collections</a>
⟩ <a href=/>home</a></div><article><h2 id=find-median-from-data-stream-lc295>Find Median from Data Stream [LC#295]</h2><blockquote><p>The median is the middle value in an ordered integer list. If the size of the list is even, there is no middle value, and the median is the mean of the two middle values.</p><ul><li>For example, for arr = [2,3,4], the median is 3.</li><li>For example, for arr = [2,3], the median is (2 + 3) / 2 = 2.5.</li></ul></blockquote><h3 id=intuition>Intuition</h3><ul><li>We can easily find median if we have access to the 2 middle elements.</li><li>The middle elements are largest of the first half and smallest of the second half if the array was sorted</li><li>We can maintain first half of elements in a max heap and second half in min heap</li><li>Always maintain insertion so that max heap has at most 1 value more than the min heap</li></ul><h3 id=code>Code</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MedianFinder</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__init__</span>(self):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>low <span style=color:#f92672>=</span> [] <span style=color:#75715e># stores n or n+1 elements</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>high <span style=color:#f92672>=</span> [] <span style=color:#75715e># stores n elements</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>add</span>(self, num: int) <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        val <span style=color:#f92672>=</span> heapq<span style=color:#f92672>.</span>heappushpop(self<span style=color:#f92672>.</span>low, <span style=color:#f92672>-</span>num)
</span></span><span style=display:flex><span>        heapq<span style=color:#f92672>.</span>heappush(self<span style=color:#f92672>.</span>high, <span style=color:#f92672>-</span>val)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> len(self<span style=color:#f92672>.</span>low) <span style=color:#f92672>&lt;</span>  len(self<span style=color:#f92672>.</span>high):
</span></span><span style=display:flex><span>            val <span style=color:#f92672>=</span> heapq<span style=color:#f92672>.</span>heappop(self<span style=color:#f92672>.</span>high)
</span></span><span style=display:flex><span>            heapq<span style=color:#f92672>.</span>heappush(self<span style=color:#f92672>.</span>low, <span style=color:#f92672>-</span>val)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>find_median</span>(self) <span style=color:#f92672>-&gt;</span> float:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> len(self<span style=color:#f92672>.</span>low) <span style=color:#f92672>&gt;</span> len(self<span style=color:#f92672>.</span>high):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span>self<span style=color:#f92672>.</span>low[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (<span style=color:#f92672>-</span>self<span style=color:#f92672>.</span>low[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> self<span style=color:#f92672>.</span>high[<span style=color:#ae81ff>0</span>])<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>
</span></span></code></pre></div><h3 id=time-complexity>Time complexity</h3><ul><li>$T(n) = O(\log n) $ for each insertion and median can be computed in $O(1)$ always</li><li>$S(n) = O(n)$ for the heaps</li></ul></article><br><br><br><i>tags:</i>
<a class=gray style=padding-right:5px href=/tags#heap><i>#heap</i></a></section></main><footer><p>Found something useful here? pass it on; or tell me about it!<nav><ul><li><a href="https://drive.google.com/drive/folders/18LU6PKnxy8rDrAXhpiPXV2yOYlO_I8cF?usp=sharing">Resume</a></li><li><a href=https://daxpy.xyz/collections/>Collections</a></li><li><a href=https://www.linkedin.com/in/ndivakar/>Linkedin</a></li></ul></nav><small><a href=#top>↑ Top of page</a></small></p></footer></body></html>