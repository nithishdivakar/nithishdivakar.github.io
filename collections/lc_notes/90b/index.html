<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><title>Segment Trees | DAXPY</title><link rel=stylesheet href=/css/main.min.d700ad2998f190f21436ef39c94129166ea316da7e0014005c9c2ced3b288a04.css integrity="sha256-1wCtKZjxkPIUNu85yUEpFm6jFtp+ABQAXJws7TsoigQ=" crossorigin=anonymous><script src=/js/main.23cd0c7d837263b9eaeb96ee2d9ccfa2969daa3fa00fa1c1fe8701a9b87251a1.js integrity="sha256-I80MfYNyY7nq65buLZzPopadqj+gD6HB/ocBqbhyUaE=" crossorigin=anonymous></script></head><body><header><nav><ul><li><a class=text_secondary href=https://daxpy.xyz/>DAXPY</a></li><li>|</li><li><a href=https://daxpy.xyz/posts/>Posts</a></li><li><a href=https://daxpy.xyz/notes/>Notes</a></li><li><a href=https://daxpy.xyz/collections/>Collections</a></li><li><a href=https://daxpy.xyz/links/>Links</a></li><li><a href=https://daxpy.xyz/stories/>Stories</a></li><li><a href=/about>About</a></li></ul></nav></header><main><section><div style=text-align:right;height:5px;margin-top:10px class=italic>this page
⟩ <a href=/collections/lc_notes/>lc notes</a>
⟩ <a href=/collections/>collections</a>
⟩ <a href=/>home</a></div><article><h3 id=segment-trees>Segment Trees</h3><ul><li>Segment Trees are a data structure where each node is responsible for a range of values.</li><li>Can do point updates in $O(\log n)$ and range queries in $O(\log n)$.</li><li>Requires $2\cdot n+1$ storage.</li><li>Implemented as a collection of complete binary tree.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>┌───────────────────────────────────────────────────────────────┐
</span></span><span style=display:flex><span>│                               1:                              │     
</span></span><span style=display:flex><span>│                             -----                             │
</span></span><span style=display:flex><span>╔═══════════════════════════════╗───────────────────────────────┤
</span></span><span style=display:flex><span>║               2:              ║               3:              │     
</span></span><span style=display:flex><span>║             [3,11)            ║             -----             │
</span></span><span style=display:flex><span>╟───────────────┬───────────────╫───────────────╔═══════════════╗
</span></span><span style=display:flex><span>║       4:      │       5:      ║       6:      ║       7:      ║
</span></span><span style=display:flex><span>║     [3,7)     │     [7,11)    ║     -----     ║     [1,3)     ║
</span></span><span style=display:flex><span>╟───────┬───────┼───────┬───────╠═══════╦═══════╣───────┬───────╢
</span></span><span style=display:flex><span>║   8:  │   9:  │  10:  │  11:  ║  12:  ║  13:  ║  14:  │  15:  ║
</span></span><span style=display:flex><span>║ [3,5) │ [5,7) │ [7,9) │ [9,11)║[11,13)║   0   ║   1   │   2   ║
</span></span><span style=display:flex><span>╟───┬───┼───┬───┼───┬───┼───┬───╫───┬───╠═══╤═══╩═══╤═══╪═══╤═══╝
</span></span><span style=display:flex><span>║16:│17:│18:│19:│20:│21:│22:│23:║24:│25:║   │   │   │   │   │   |
</span></span><span style=display:flex><span>║ 3 │ 4 │ 5 │ 6 │ 7 │ 8 │ 9 │10 ║11 │12 ║   │   │   │   │   │   │
</span></span><span style=display:flex><span>╚═══╧═══╧═══╧═══╧═══╧═══╧═══╧═══╩═══╧═══╝───┴───┴───┴───┴───┴───┘
</span></span><span style=display:flex><span>┌─────────┐
</span></span><span style=display:flex><span>│Tree idx:│
</span></span><span style=display:flex><span>│  range  │
</span></span><span style=display:flex><span>└─────────┘
</span></span></code></pre></div><p>References</p><ul><li><a href=https://codeforces.com/blog/entry/18051>https://codeforces.com/blog/entry/18051</a></li><li><a href="https://www.youtube.com/watch?v=xztU7lmDLv8">https://www.youtube.com/watch?v=xztU7lmDLv8</a></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>OP <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> a, b: min(a, b)
</span></span><span style=display:flex><span>E <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> : math<span style=color:#f92672>.</span>inf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SegTree</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__init__</span>(self, A: List[int]) <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        n <span style=color:#f92672>=</span> len(A)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>T: List[int] <span style=color:#f92672>=</span> [E()] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> n)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n):
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>T[n <span style=color:#f92672>+</span> i] <span style=color:#f92672>=</span> A[i]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>T[i] <span style=color:#f92672>=</span> OP(self<span style=color:#f92672>.</span>T[<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> i] , self<span style=color:#f92672>.</span>T[<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>n: int <span style=color:#f92672>=</span> n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__getitem__</span>(self, i: int) <span style=color:#f92672>-&gt;</span> int:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>T[self<span style=color:#f92672>.</span>n <span style=color:#f92672>+</span> i]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>point_update</span>(self, i: int, value: int) <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        i <span style=color:#f92672>+=</span> self<span style=color:#f92672>.</span>n
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>T[i] <span style=color:#f92672>=</span> value
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> i <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>            i <span style=color:#f92672>//=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>T[i] <span style=color:#f92672>=</span> OP(self<span style=color:#f92672>.</span>T[<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> i] , self<span style=color:#f92672>.</span>T[<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>range_query</span>(self, l: int, r: int) <span style=color:#f92672>-&gt;</span> int: <span style=color:#75715e># [l, r)</span>
</span></span><span style=display:flex><span>        res_l, res_r <span style=color:#f92672>=</span> E(), E()
</span></span><span style=display:flex><span>        l <span style=color:#f92672>+=</span> self<span style=color:#f92672>.</span>n
</span></span><span style=display:flex><span>        r <span style=color:#f92672>+=</span> self<span style=color:#f92672>.</span>n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> l <span style=color:#f92672>&lt;</span> r:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> l <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>                res_l <span style=color:#f92672>=</span> OP(res_l, self<span style=color:#f92672>.</span>T[l])
</span></span><span style=display:flex><span>                l <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> r <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>                r <span style=color:#f92672>-=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                res_r <span style=color:#f92672>=</span> OP(self<span style=color:#f92672>.</span>T[r], res_r)
</span></span><span style=display:flex><span>            l <span style=color:#f92672>//=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>            r <span style=color:#f92672>//=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> OP(res_l, res_r)
</span></span></code></pre></div></article><br><br><br><i>tags:</i>
<a class=gray style=padding-right:5px href=/tags#segment%20trees><i>#segment trees</i></a>
<a class=gray style=padding-right:5px href=/tags#rmq><i>#rmq</i></a></section></main><footer><p>Found something useful here? pass it on; or tell me about it!<nav><ul><li><a href="https://drive.google.com/drive/folders/18LU6PKnxy8rDrAXhpiPXV2yOYlO_I8cF?usp=sharing">Resume</a></li><li><a href=https://daxpy.xyz/collections/>Collections</a></li><li><a href=https://www.linkedin.com/in/ndivakar/>Linkedin</a></li></ul></nav><small><a href=#top>↑ Top of page</a></small></p></footer></body></html>